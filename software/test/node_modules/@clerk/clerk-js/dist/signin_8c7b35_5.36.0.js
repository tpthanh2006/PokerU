"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["722"],{7389:function(e,t,o){o.d(t,{v:function(){return a}});var r=o(7126),n=o(3064),i=o(9885);let a=e=>{let{onBackLinkClick:t}=e;return(0,r.tZ)(i.ErrorCard,{cardTitle:(0,n.localizationKeys)("signIn.alternativeMethods.getHelp.title"),cardSubtitle:(0,n.localizationKeys)("signIn.alternativeMethods.getHelp.content"),onBackLinkClick:t})}},1822:function(e,t,o){o.r(t),o.d(t,{SignIn:()=>ef,SignInModal:()=>eg});var r=o("7126"),n=o("2631"),i=o("4194"),a=o("5112"),s=o("7571"),l=o("3064"),c=o("4676"),d=o("4152"),u=o("9885"),p=o("6391"),h=o("3234"),m=o("1132");let I=(0,u.withCardStateProvider)(()=>{let e=(0,s.useCoreSignIn)(),t=(0,u.useCardState)(),{navigate:o}=(0,c.useRouter)(),n=(0,h.H)(),{userSettings:{passwordSettings:a}}=(0,s.useEnvironment)(),{t:I,locale:f}=(0,l.useLocalizations)(),g="needs_new_password"===e.status&&"reset_password_email_code"!==e.firstFactorVerification.strategy&&"reset_password_phone_code"!==e.firstFactorVerification.strategy;i.useEffect(()=>{g&&t.setError(I((0,l.localizationKeys)("signIn.resetPassword.requiredMessage")))},[]);let v=(0,m.Yp)("password","",{type:"password",label:(0,l.localizationKeys)("formFieldLabel__newPassword"),isRequired:!0,validatePassword:!0,buildErrorMessage:e=>(0,m.GM)(e,{t:I,locale:f,passwordSettings:a})}),C=(0,m.Yp)("confirmPassword","",{type:"password",label:(0,l.localizationKeys)("formFieldLabel__confirmPassword"),isRequired:!0}),B=(0,m.Yp)("signOutOfOtherSessions","",{type:"checkbox",label:(0,l.localizationKeys)("formFieldLabel__signOutOfOtherSessions"),defaultChecked:!0}),{setConfirmPasswordFeedback:S,isPasswordMatch:w}=(0,p.p5)({passwordField:v,confirmPasswordField:C}),y=async()=>{v.clearFeedback(),C.clearFeedback();try{let{status:t,createdSessionId:r}=await e.resetPassword({password:v.value,signOutOfOtherSessions:B.checked});switch(t){case"complete":if(r){let e=new URLSearchParams;return e.set("createdSessionId",r),o("../reset-password-success?".concat(e.toString()))}return console.error((0,d.Ws)(t,n));case"needs_second_factor":return o("../factor-two");default:return console.error((0,d.Ws)(t,n))}}catch(e){return(0,m.S3)(e,[v,C],t.setError)}};return(0,r.BX)(u.Card.Root,{children:[(0,r.BX)(u.Card.Content,{children:[(0,r.tZ)(u.Header.Root,{showLogo:!0,children:(0,r.tZ)(u.Header.Title,{localizationKey:(0,l.localizationKeys)("signIn.resetPassword.title")})}),(0,r.tZ)(u.Card.Alert,{children:t.error}),(0,r.tZ)(l.Col,{elementDescriptor:l.descriptors.main,gap:8,children:(0,r.BX)(u.Form.Root,{onSubmit:y,onBlur:()=>{v.value&&S(C.value)},gap:8,children:[(0,r.BX)(l.Col,{gap:6,children:[(0,r.tZ)("input",{readOnly:!0,"data-testid":"hidden-identifier",id:"identifier-field",name:"identifier",value:e.identifier||"",style:{display:"none"}}),(0,r.tZ)(u.Form.ControlRow,{elementId:v.id,children:(0,r.tZ)(u.Form.PasswordInput,{...v.props,isRequired:!0,autoFocus:!0})}),(0,r.tZ)(u.Form.ControlRow,{elementId:C.id,children:(0,r.tZ)(u.Form.PasswordInput,{...C.props,onChange:e=>(e.target.value&&S(e.target.value),C.props.onChange(e))})}),!g&&(0,r.tZ)(u.Form.ControlRow,{elementId:B.id,children:(0,r.tZ)(u.Form.Checkbox,{...B.props})})]}),(0,r.BX)(l.Col,{gap:3,children:[(0,r.tZ)(u.Form.SubmitButton,{isDisabled:!w,localizationKey:(0,l.localizationKeys)("signIn.resetPassword.formButtonPrimary")}),(0,r.tZ)(u.Card.Action,{elementId:"alternativeMethods",children:(0,r.tZ)(u.Card.ActionLink,{elementDescriptor:l.descriptors.backLink,localizationKey:(0,l.localizationKeys)("backButton"),onClick:()=>o("../")})})]})]})})]}),(0,r.tZ)(u.Card.Footer,{})]})});var f=o("4875"),g=o("7643");let v=(0,u.withCardStateProvider)(()=>{let e=(0,u.useCardState)();return(0,f.E)(),(0,r.BX)(u.Card.Root,{children:[(0,r.BX)(u.Card.Content,{children:[(0,r.tZ)(u.Header.Root,{showLogo:!0,children:(0,r.tZ)(u.Header.Title,{localizationKey:(0,l.localizationKeys)("signIn.resetPassword.title")})}),(0,r.tZ)(u.Card.Alert,{children:e.error}),(0,r.BX)(l.Col,{elementDescriptor:l.descriptors.main,gap:8,children:[(0,r.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("signIn.resetPassword.successMessage")}),(0,r.tZ)(g.kC,{direction:"row",center:!0,children:(0,r.tZ)(l.Spinner,{size:"xl",colorScheme:"primary",elementDescriptor:l.descriptors.spinner})})]})]}),(0,r.tZ)(u.Card.Footer,{})]})});var C=o("8969"),B=o("9037"),S=o("8655"),w=o("9327"),y=o("5241");let _=(0,C.Hy)((0,u.withCardStateProvider)(()=>{let e=(0,B.v)(),{userProfileUrl:t}=(0,s.useEnvironment)().displayConfig,{navigateAfterSignIn:o,afterSignInUrl:n,path:i}=(0,s.useSignInContext)(),{navigateAfterSignOut:a}=(0,s.useSignOutContext)(),{handleSignOutAllClicked:c,handleSessionClicked:d,activeSessions:p,handleAddAccountClicked:h}=(0,y.Z)({navigateAfterSignOut:a,navigateAfterSwitchSession:o,afterSignInUrl:n,userProfileUrl:t,signInUrl:i,user:void 0});return(0,r.tZ)(l.Flow.Part,{part:"accountSwitcher",children:(0,r.BX)(u.Card.Root,{children:[(0,r.BX)(u.Card.Content,{sx:e=>({padding:"".concat(e.space.$8," ").concat(e.space.$none," ").concat(e.space.$none)}),children:[(0,r.BX)(u.Header.Root,{children:[(0,r.tZ)(u.Header.Title,{localizationKey:(0,l.localizationKeys)("signIn.accountSwitcher.title")}),(0,r.tZ)(u.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("signIn.accountSwitcher.subtitle")})]}),(0,r.tZ)(u.Card.Alert,{children:e.error}),(0,r.tZ)(l.Col,{elementDescriptor:l.descriptors.main,gap:8,sx:e=>({borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100}),children:(0,r.BX)(u.Actions,{role:"menu",children:[p.map(e=>(0,r.tZ)(u.PreviewButton,{onClick:d(e),sx:e=>({height:e.sizes.$16,justifyContent:"flex-start",borderRadius:0}),icon:S.nR,children:(0,r.tZ)(u.UserPreview,{user:e.user,sx:{width:"100%"}})},e.id)),(0,r.tZ)(u.Action,{elementDescriptor:l.descriptors.accountSwitcherActionButton,elementId:l.descriptors.accountSwitcherActionButton.setId("addAccount"),iconBoxElementDescriptor:l.descriptors.accountSwitcherActionButtonIconBox,iconBoxElementId:l.descriptors.accountSwitcherActionButtonIconBox.setId("addAccount"),iconElementDescriptor:l.descriptors.accountSwitcherActionButtonIcon,iconElementId:l.descriptors.accountSwitcherActionButtonIcon.setId("addAccount"),icon:S.mm,label:(0,l.localizationKeys)("signIn.accountSwitcher.action__addAccount"),onClick:h,iconSx:e=>({width:e.sizes.$9,height:e.sizes.$6}),iconBoxSx:e=>({minHeight:e.sizes.$9,minWidth:e.sizes.$6,alignItems:"center"}),spinnerSize:"md"})]})})]}),(0,r.tZ)(u.Card.Footer,{sx:e=>({">:first-of-type":{padding:"".concat(e.space.$1),width:"100%"}}),children:(0,r.tZ)(u.Card.Action,{sx:{width:"100%",">:first-of-type":{width:"100%",borderBottomWidth:0}},children:(0,r.tZ)(w.gW,{handleSignOutAllClicked:c,elementDescriptor:l.descriptors.accountSwitcherActionButton,elementId:l.descriptors.accountSwitcherActionButton.setId("signOutAll"),iconBoxElementDescriptor:l.descriptors.accountSwitcherActionButtonIconBox,iconBoxElementId:l.descriptors.accountSwitcherActionButtonIconBox.setId("signOutAll"),iconElementDescriptor:l.descriptors.accountSwitcherActionButtonIcon,iconElementId:l.descriptors.accountSwitcherActionButtonIcon.setId("signOutAll"),label:(0,l.localizationKeys)("signIn.accountSwitcher.action__signOutAll"),actionSx:e=>({padding:"".concat(e.space.$2," ").concat(e.space.$2)})})})})]})})}));var A=o("1752"),b=o("1085"),k=o("6749"),Z=o("5747"),P=o("138");let F=i.memo(e=>{let t=(0,n.cL)(),{navigate:o}=(0,c.useRouter)(),i=(0,B.v)(),{displayConfig:a}=(0,Z.O)(),l=(0,s.useSignInContext)(),d=(0,s.useCoreSignIn)(),u=(0,k.w)(l,a.signInUrl),p=l.afterSignInUrl||"/";return(0,r.tZ)(P.L,{...e,oauthCallback:e=>d.authenticateWithRedirect({strategy:e,redirectUrl:u,redirectUrlComplete:p}).catch(e=>(0,m.S3)(e,[],i.setError)),web3Callback:e=>t.authenticateWithWeb3({customNavigate:o,redirectUrl:p,signUpContinueUrl:l.signUpContinueUrl,strategy:e}).catch(e=>(0,m.S3)(e,[],i.setError))})});var z=o("5518");function E(){var e;return null===(e=(0,s.useCoreSignIn)().supportedFirstFactors)||void 0===e?void 0:e.find(e=>{let{strategy:t}=e;return(0,z.Vh)(t)})}var L=o("7389");let K=(e,t)=>{let[o,n]=i.useState(!1),a=i.useCallback(()=>n(e=>!e),[n]);return o?(0,r.tZ)(L.v,{onBackLinkClick:a}):(0,r.tZ)(e,{...t,onHavingTroubleClick:a})},x=e=>K(T,{...e}),T=e=>{let{onBackLinkClick:t,onHavingTroubleClick:o,onFactorSelected:n,mode:i="default"}=e,a=(0,B.v)(),c=E(),{supportedFirstFactors:d}=(0,s.useCoreSignIn)(),{firstPartyFactors:p,hasAnyStrategy:h}=(0,A.l)({filterOutFactor:null==e?void 0:e.currentFactor,supportedFirstFactors:d}),m=function(e){switch(e){case"forgot":return"forgotPasswordMethods";case"pwned":return"passwordPwnedMethods";default:return"alternativeMethods"}}(i),I=function(e){switch(e){case"forgot":return(0,l.localizationKeys)("signIn.forgotPasswordAlternativeMethods.title");case"pwned":return(0,l.localizationKeys)("signIn.passwordPwned.title");default:return(0,l.localizationKeys)("signIn.alternativeMethods.title")}}(i),f=function(e){switch(e){case"forgot":case"pwned":return!0;default:return!1}}(i);return(0,r.tZ)(l.Flow.Part,{part:m,children:(0,r.BX)(u.Card.Root,{children:[(0,r.BX)(u.Card.Content,{children:[(0,r.BX)(u.Header.Root,{showLogo:!0,children:[(0,r.tZ)(u.Header.Title,{localizationKey:I}),!f&&(0,r.tZ)(u.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("signIn.alternativeMethods.subtitle")})]}),(0,r.tZ)(u.Card.Alert,{children:a.error}),(0,r.BX)(l.Flex,{direction:"col",elementDescriptor:l.descriptors.main,gap:6,children:[f&&c&&(0,r.tZ)(l.Button,{localizationKey:M(c),elementDescriptor:l.descriptors.alternativeMethodsBlockButton,isDisabled:a.isLoading,onClick:()=>{a.setError(void 0),n(c)}}),f&&h&&(0,r.tZ)(u.Divider,{dividerText:(0,l.localizationKeys)("signIn.forgotPasswordAlternativeMethods.label__alternativeMethods")}),(0,r.BX)(l.Col,{gap:4,children:[h&&(0,r.BX)(l.Flex,{elementDescriptor:l.descriptors.alternativeMethods,direction:"col",gap:2,children:[(0,r.tZ)(F,{enableWeb3Providers:!0,enableOAuthProviders:!0}),p&&p.map((e,t)=>{var o;return(0,r.tZ)(u.ArrowBlockButton,{leftIcon:(o=e,({email_link:S.xP,email_code:S.GT,phone_code:S.iU,reset_password_email_code:S.ds,reset_password_phone_code:S.ds,password:S.kh,passkey:S.IG})[o.strategy]),textLocalizationKey:M(e),elementDescriptor:l.descriptors.alternativeMethodsBlockButton,textElementDescriptor:l.descriptors.alternativeMethodsBlockButtonText,arrowElementDescriptor:l.descriptors.alternativeMethodsBlockButtonArrow,textVariant:"buttonLarge",isDisabled:a.isLoading,onClick:()=>{a.setError(void 0),n(e)}},t)})]}),t&&(0,r.tZ)(u.BackLink,{boxElementDescriptor:l.descriptors.backRow,linkElementDescriptor:l.descriptors.backLink,onClick:t})]})]})]}),(0,r.tZ)(u.Card.Footer,{children:(0,r.BX)(u.Card.Action,{elementId:"havingTrouble",children:[(0,r.tZ)(u.Card.ActionText,{localizationKey:(0,l.localizationKeys)("signIn.alternativeMethods.actionText")}),(0,r.tZ)(u.Card.ActionLink,{localizationKey:(0,l.localizationKeys)("signIn.alternativeMethods.actionLink"),onClick:o})]})})]})})};function M(e){switch(e.strategy){case"email_link":return(0,l.localizationKeys)("signIn.alternativeMethods.blockButton__emailLink",{identifier:(0,m.HT)(e.safeIdentifier)||""});case"email_code":return(0,l.localizationKeys)("signIn.alternativeMethods.blockButton__emailCode",{identifier:(0,m.HT)(e.safeIdentifier)||""});case"phone_code":return(0,l.localizationKeys)("signIn.alternativeMethods.blockButton__phoneCode",{identifier:(0,m.HT)(e.safeIdentifier)||""});case"password":return(0,l.localizationKeys)("signIn.alternativeMethods.blockButton__password");case"passkey":return(0,l.localizationKeys)("signIn.alternativeMethods.blockButton__passkey");case"reset_password_email_code":case"reset_password_phone_code":return(0,l.localizationKeys)("signIn.forgotPasswordAlternativeMethods.blockButton__resetPassword");default:throw'Invalid sign in strategy: "'.concat(e.strategy,'"')}}var R=o("2434");let U=e=>{let t=(0,s.useCoreSignIn)(),o=(0,u.useCardState)(),{navigate:a}=(0,c.useRouter)(),{afterSignInUrl:l}=(0,s.useSignInContext)(),{setActive:p}=(0,n.cL)(),I=(0,h.H)(),f=(0,n.cL)();i.useEffect(()=>{e.factorAlreadyPrepared||g()},[]);let g=()=>{t.prepareFirstFactor(e.factor).then(()=>e.onFactorPrepare()).catch(e=>(0,m.S3)(e,[],o.setError))};return(0,r.tZ)(u.VerificationCodeCard,{cardTitle:e.cardTitle,cardSubtitle:e.cardSubtitle,inputLabel:e.inputLabel,resendButton:e.resendButton,onCodeEntryFinishedAction:(o,r,n)=>{t.attemptFirstFactor({strategy:e.factor.strategy,code:o}).then(async e=>{switch(await r(),e.status){case"complete":return p({session:e.createdSessionId,redirectUrl:l});case"needs_second_factor":return a("../factor-two");case"needs_new_password":return a("../reset-password");default:return console.error((0,d.Ws)(e.status,I))}}).catch(e=>(0,R.ay)(e)?f.__internal_navigateWithError("..",e.errors[0]):n(e))},onResendCodeClicked:g,safeIdentifier:e.factor.safeIdentifier,profileImageUrl:t.userData.imageUrl,onShowAlternativeMethodsClicked:e.onShowAlternativeMethodsClicked,showAlternativeMethods:e.showAlternativeMethods,onIdentityPreviewEditClicked:()=>a("../"),onBackLinkClicked:e.onBackLinkClicked})},D=e=>(0,r.tZ)(l.Flow.Part,{part:"emailCode",children:(0,r.tZ)(U,{...e,cardTitle:(0,l.localizationKeys)("signIn.emailCode.title"),cardSubtitle:(0,l.localizationKeys)("signIn.emailCode.subtitle"),inputLabel:(0,l.localizationKeys)("signIn.emailCode.formTitle"),resendButton:(0,l.localizationKeys)("signIn.emailCode.resendButton")})});var O=o("4814"),H=o("3241");let X=e=>{let{t}=(0,l.useLocalizations)(),o=(0,B.v)(),a=(0,s.useCoreSignIn)(),c=(0,s.useSignInContext)(),{signInUrl:d}=c,{navigate:p}=(0,H.t)(),{afterSignInUrl:h}=(0,s.useSignInContext)(),{setActive:I}=(0,n.cL)(),{startEmailLinkFlow:f,cancelEmailLinkFlow:g}=(0,O.E)(a),[v,S]=i.useState(!1),w=(0,n.cL)();i.useEffect(()=>{y()},[]);let y=()=>{f({emailAddressId:e.factor.emailAddressId,redirectUrl:(0,k.d)(c,d)}).then(e=>_(e)).catch(e=>{if((0,R.ay)(e))return w.__internal_navigateWithError("..",e.errors[0]);(0,m.S3)(e,[],o.setError)})},_=async e=>{let r=e.firstFactorVerification;"expired"===r.status?o.setError(t((0,l.localizationKeys)("formFieldError__verificationLinkExpired"))):r.verifiedFromTheSameClient()?S(!0):await A(e)},A=async e=>"complete"===e.status?I({session:e.createdSessionId,redirectUrl:h}):"needs_second_factor"===e.status?p("../factor-two"):void 0;return v?(0,r.tZ)(C.Ej,{title:(0,l.localizationKeys)("signIn.emailLink.verifiedSwitchTab.titleNewTab"),subtitle:(0,l.localizationKeys)("signIn.emailLink.verifiedSwitchTab.subtitleNewTab"),status:"verified_switch_tab"}):(0,r.tZ)(l.Flow.Part,{part:"emailLink",children:(0,r.tZ)(u.VerificationLinkCard,{cardTitle:(0,l.localizationKeys)("signIn.emailLink.title"),cardSubtitle:(0,l.localizationKeys)("signIn.emailLink.subtitle"),formTitle:(0,l.localizationKeys)("signIn.emailLink.formTitle"),formSubtitle:(0,l.localizationKeys)("signIn.emailLink.formSubtitle"),resendButton:(0,l.localizationKeys)("signIn.emailLink.resendButton"),onResendCodeClicked:()=>{g(),y()},safeIdentifier:e.factor.safeIdentifier,profileImageUrl:a.userData.imageUrl,onShowAlternativeMethodsClicked:e.onShowAlternativeMethodsClicked})})},$=e=>(0,r.tZ)(l.Flow.Part,{part:"resetPassword",children:(0,r.tZ)(U,{...e,showAlternativeMethods:!1,cardTitle:(0,l.localizationKeys)("signIn.forgotPassword.title"),inputLabel:(0,l.localizationKeys)("signIn.forgotPassword.formTitle"),resendButton:(0,l.localizationKeys)("signIn.forgotPassword.resendButton")})});var W=o("3367");function N(e){let t=(0,u.useCardState)(),{setActive:o,__internal_navigateWithError:r}=(0,n.cL)(),a=(0,h.H)(),{afterSignInUrl:l}=(0,s.useSignInContext)(),{authenticateWithPasskey:c}=(0,s.useCoreSignIn)();return(0,i.useEffect)(()=>()=>{W.YI.abort()},[]),(0,i.useCallback)(async function(){for(var n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];try{let t=await c(...i);switch(t.status){case"complete":return o({session:t.createdSessionId,redirectUrl:l});case"needs_second_factor":return e();default:return console.error((0,d.Ws)(t.status,a))}}catch(o){let{flow:e}=i[0]||{};if((0,R.uX)(o)&&("passkey_operation_aborted"===o.code||"autofill"===e&&"passkey_retrieval_cancelled"===o.code))return;if((0,R.ay)(o))return r("..",o.errors[0]);(0,m.S3)(o,[],t.setError)}},[])}let V=e=>{let{onShowAlternativeMethodsClick:t}=e,o=(0,u.useCardState)(),n=(0,s.useCoreSignIn)(),{navigate:a}=(0,H.t)(),[c,d]=i.useState(!1),p=i.useCallback(()=>d(e=>!e),[d]),h=N(()=>a("../factor-two"));return c?(0,r.tZ)(L.v,{onBackLinkClick:p}):(0,r.tZ)(l.Flow.Part,{part:"password",children:(0,r.BX)(u.Card.Root,{children:[(0,r.BX)(u.Card.Content,{children:[(0,r.BX)(u.Header.Root,{showLogo:!0,children:[(0,r.tZ)(l.Icon,{elementDescriptor:l.descriptors.passkeyIcon,icon:S.IG,sx:e=>({color:e.colors.$neutralAlpha500,marginInline:"auto",paddingBottom:e.sizes.$1,width:e.sizes.$12,height:e.sizes.$12})}),(0,r.tZ)(u.Header.Title,{localizationKey:(0,l.localizationKeys)("signIn.passkey.title")}),(0,r.tZ)(u.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("signIn.passkey.subtitle")}),(0,r.tZ)(u.IdentityPreview,{identifier:n.identifier,avatarUrl:n.userData.imageUrl,onClick:()=>a("../")})]}),(0,r.tZ)(u.Card.Alert,{children:o.error}),(0,r.BX)(l.Flex,{direction:"col",elementDescriptor:l.descriptors.main,gap:4,children:[(0,r.tZ)(u.Form.Root,{onSubmit:e=>(e.preventDefault(),h()),gap:8,children:(0,r.tZ)(u.Form.SubmitButton,{hasArrow:!0})}),(0,r.tZ)(u.Card.Action,{elementId:t?"alternativeMethods":"havingTrouble",children:(0,r.tZ)(u.Card.ActionLink,{localizationKey:(0,l.localizationKeys)(t?"footerActionLink__useAnotherMethod":"signIn.alternativeMethods.actionLink"),onClick:t||p})})]})]}),(0,r.tZ)(u.Card.Footer,{})]})})},G=e=>{let{onForgotPasswordMethodClick:t,onShowAlternativeMethodsClick:o}=e,r=E(),n=(0,m.Yp)("password","",{type:"password",label:(0,l.localizationKeys)("formFieldLabel__password"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__password")});return{...n,props:{...n.props,actionLabel:r||o?(0,l.localizationKeys)("formFieldAction__forgotPassword"):"",onActionClicked:t||o||(()=>null)}}},j=e=>{let{onShowAlternativeMethodsClick:t,onPasswordPwned:o}=e,a=i.useRef(null),c=(0,u.useCardState)(),{setActive:p}=(0,n.cL)(),I=(0,s.useCoreSignIn)(),{afterSignInUrl:f}=(0,s.useSignInContext)(),g=(0,h.H)(),v=G(e),{navigate:C}=(0,H.t)(),[B,S]=i.useState(!1),w=i.useCallback(()=>S(e=>!e),[S]),y=(0,n.cL)(),_=async e=>(e.preventDefault(),I.attemptFirstFactor({strategy:"password",password:v.value}).then(e=>{switch(e.status){case"complete":return p({session:e.createdSessionId,redirectUrl:f});case"needs_second_factor":return C("../factor-two");default:return console.error((0,d.Ws)(e.status,g))}}).catch(e=>{if((0,R.ay)(e))return y.__internal_navigateWithError("..",e.errors[0]);if((0,R.UZ)(e)&&o){c.setError({...e.errors[0],code:"form_password_pwned__sign_in"}),o();return}(0,m.S3)(e,[v],c.setError),setTimeout(()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.focus()},0)}));return B?(0,r.tZ)(L.v,{onBackLinkClick:w}):(0,r.tZ)(l.Flow.Part,{part:"password",children:(0,r.BX)(u.Card.Root,{children:[(0,r.BX)(u.Card.Content,{children:[(0,r.BX)(u.Header.Root,{showLogo:!0,children:[(0,r.tZ)(u.Header.Title,{localizationKey:(0,l.localizationKeys)("signIn.password.title")}),(0,r.tZ)(u.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("signIn.password.subtitle")}),(0,r.tZ)(u.IdentityPreview,{identifier:I.identifier,avatarUrl:I.userData.imageUrl,onClick:()=>C("../")})]}),(0,r.tZ)(u.Card.Alert,{children:c.error}),(0,r.BX)(l.Flex,{direction:"col",elementDescriptor:l.descriptors.main,gap:4,children:[(0,r.BX)(u.Form.Root,{onSubmit:_,gap:8,children:[(0,r.tZ)("input",{readOnly:!0,id:"identifier-field",name:"identifier",value:I.identifier||"",style:{display:"none"}}),(0,r.tZ)(u.Form.ControlRow,{elementId:v.id,children:(0,r.tZ)(u.Form.PasswordInput,{...v.props,ref:a,autoFocus:!0})}),(0,r.tZ)(u.Form.SubmitButton,{hasArrow:!0})]}),(0,r.tZ)(u.Card.Action,{elementId:t?"alternativeMethods":"havingTrouble",children:(0,r.tZ)(u.Card.ActionLink,{localizationKey:(0,l.localizationKeys)(t?"signIn.password.actionLink":"signIn.alternativeMethods.actionLink"),onClick:t||w})})]})]}),(0,r.tZ)(u.Card.Footer,{})]})})},Y=e=>{let{applicationName:t}=(0,s.useEnvironment)().displayConfig;return(0,r.tZ)(l.Flow.Part,{part:"phoneCode",children:(0,r.tZ)(U,{...e,cardTitle:(0,l.localizationKeys)("signIn.phoneCode.title"),cardSubtitle:(0,l.localizationKeys)("signIn.phoneCode.subtitle",{applicationName:t}),inputLabel:(0,l.localizationKeys)("signIn.phoneCode.formTitle"),resendButton:(0,l.localizationKeys)("signIn.phoneCode.resendButton")})})},q=e=>{if(!e)return"";let t=e.strategy;return"emailAddressId"in e&&(t+=e.emailAddressId),"phoneNumberId"in e&&(t+=e.phoneNumberId),t},J=(0,C.Hy)((0,u.withCardStateProvider)(function(){let e=(0,s.useCoreSignIn)(),{preferredSignInStrategy:t}=(0,s.useEnvironment)().displayConfig,o=e.supportedFirstFactors,n=(0,c.useRouter)(),a=(0,u.useCardState)(),{supportedFirstFactors:l}=(0,s.useCoreSignIn)(),d=i.useRef(""),[{currentFactor:p},h]=i.useState(()=>({currentFactor:(0,z.t3)(o,e.identifier,t),prevCurrentFactor:void 0})),{hasAnyStrategy:m}=(0,A.l)({filterOutFactor:p,supportedFirstFactors:l}),[I,f]=i.useState(()=>!p||!(0,z.xT)(p)),g=E(),[v,C]=i.useState(!1),[B,S]=i.useState(!1);if(i.useEffect(()=>{("needs_identifier"===e.status||null===e.status)&&n.navigate("../")},[]),!p&&e.status)return(0,r.tZ)(u.ErrorCard,{cardTitle:(0,b.u1)("signIn.noAvailableMethods.title"),cardSubtitle:(0,b.u1)("signIn.noAvailableMethods.subtitle"),message:(0,b.u1)("signIn.noAvailableMethods.message")});let w=m?()=>f(e=>!e):void 0,y=()=>C(e=>!e),_=()=>{d.current=q(p)},k=e=>{h(t=>({currentFactor:e,prevCurrentFactor:t.currentFactor}))};if(I||v){let e=(0,z.xT)(p),t=I?w:y;return(0,r.tZ)(x,{mode:v?B?"pwned":"forgot":"default",onBackLinkClick:e?()=>{a.setError(void 0),S(!1),null==t||t()}:void 0,onFactorSelected:e=>{k(e),null==t||t()},currentFactor:p})}if(!p)return(0,r.tZ)(u.LoadingCard,{});switch(null==p?void 0:p.strategy){case"passkey":return(0,r.tZ)(V,{onFactorPrepare:_,onShowAlternativeMethodsClick:w});case"password":return(0,r.tZ)(j,{onForgotPasswordMethodClick:g?y:w,onShowAlternativeMethodsClick:w,onPasswordPwned:()=>{S(!0),y()}});case"email_code":return(0,r.tZ)(D,{factorAlreadyPrepared:d.current===q(p),onFactorPrepare:_,factor:p,onShowAlternativeMethodsClicked:w});case"phone_code":return(0,r.tZ)(Y,{factorAlreadyPrepared:d.current===q(p),onFactorPrepare:_,factor:p,onShowAlternativeMethodsClicked:w});case"email_link":return(0,r.tZ)(X,{factorAlreadyPrepared:d.current===q(p),onFactorPrepare:_,factor:p,onShowAlternativeMethodsClicked:w});case"reset_password_phone_code":return(0,r.tZ)($,{factorAlreadyPrepared:d.current===q(p),onFactorPrepare:_,factor:p,onShowAlternativeMethodsClicked:w,onBackLinkClicked:()=>{h(e=>({currentFactor:e.prevCurrentFactor,prevCurrentFactor:e.currentFactor})),y()},cardSubtitle:(0,b.u1)("signIn.forgotPassword.subtitle_phone")});case"reset_password_email_code":return(0,r.tZ)($,{factorAlreadyPrepared:d.current===q(p),onFactorPrepare:_,factor:p,onShowAlternativeMethodsClicked:w,onBackLinkClicked:()=>{h(e=>({currentFactor:e.prevCurrentFactor,prevCurrentFactor:e.currentFactor})),y()},cardSubtitle:(0,b.u1)("signIn.forgotPassword.subtitle_email")});default:return(0,r.tZ)(u.LoadingCard,{})}})),Q=e=>{let[t,o]=i.useState(!1),n=i.useCallback(()=>o(e=>!e),[o]);return t?(0,r.tZ)(L.v,{onBackLinkClick:n}):(0,r.tZ)(ee,{onBackLinkClick:e.onBackLinkClick,onFactorSelected:e.onFactorSelected,onHavingTroubleClick:n})},ee=e=>{let{onHavingTroubleClick:t,onFactorSelected:o,onBackLinkClick:n}=e,i=(0,B.v)(),{supportedSecondFactors:a}=(0,s.useCoreSignIn)();return(0,r.tZ)(l.Flow.Part,{part:"alternativeMethods",children:(0,r.BX)(u.Card.Root,{children:[(0,r.BX)(u.Card.Content,{children:[(0,r.BX)(u.Header.Root,{showLogo:!0,children:[(0,r.tZ)(u.Header.Title,{localizationKey:(0,l.localizationKeys)("signIn.alternativeMethods.title")}),(0,r.tZ)(u.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("signIn.alternativeMethods.subtitle")})]}),(0,r.tZ)(u.Card.Alert,{children:i.error}),(0,r.BX)(l.Col,{elementDescriptor:l.descriptors.main,gap:3,children:[(0,r.tZ)(l.Col,{gap:2,children:a&&a.sort(m.Q0).map((e,t)=>(0,r.tZ)(u.ArrowBlockButton,{textLocalizationKey:function(e){switch(e.strategy){case"phone_code":return(0,l.localizationKeys)("signIn.alternativeMethods.blockButton__phoneCode",{identifier:(0,m.HT)(e.safeIdentifier)||""});case"totp":return(0,l.localizationKeys)("signIn.alternativeMethods.blockButton__totp");case"backup_code":return(0,l.localizationKeys)("signIn.alternativeMethods.blockButton__backupCode");default:throw'Invalid sign in strategy: "'.concat(e.strategy,'"')}}(e),elementDescriptor:l.descriptors.alternativeMethodsBlockButton,textElementDescriptor:l.descriptors.alternativeMethodsBlockButtonText,arrowElementDescriptor:l.descriptors.alternativeMethodsBlockButtonArrow,isDisabled:i.isLoading,onClick:()=>o(e)},t))}),(0,r.tZ)(u.Card.Action,{elementId:"alternativeMethods",children:n&&(0,r.tZ)(u.Card.ActionLink,{localizationKey:(0,l.localizationKeys)("backButton"),onClick:e.onBackLinkClick})})]})]}),(0,r.tZ)(u.Card.Footer,{children:(0,r.BX)(u.Card.Action,{elementId:"havingTrouble",children:[(0,r.tZ)(u.Card.ActionText,{localizationKey:(0,l.localizationKeys)("signIn.alternativeMethods.actionText")}),(0,r.tZ)(u.Card.ActionLink,{localizationKey:(0,l.localizationKeys)("signIn.alternativeMethods.actionLink"),onClick:t})]})})]})})},et=e=>{let{onShowAlternativeMethodsClicked:t}=e,o=(0,s.useCoreSignIn)(),{afterSignInUrl:i}=(0,s.useSignInContext)(),{setActive:a}=(0,n.cL)(),{navigate:p}=(0,c.useRouter)(),I=(0,h.H)(),f=(0,u.useCardState)(),g=(0,m.Yp)("code","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__backupCode"),isRequired:!0}),v=(0,n.cL)(),C=e=>{var t,o;return(0,z.Vh)(null===(t=e.firstFactorVerification)||void 0===t?void 0:t.strategy)&&(null===(o=e.firstFactorVerification)||void 0===o?void 0:o.status)==="verified"};return(0,r.BX)(u.Card.Root,{children:[(0,r.BX)(u.Card.Content,{children:[(0,r.BX)(u.Header.Root,{showLogo:!0,children:[(0,r.tZ)(u.Header.Title,{localizationKey:(0,l.localizationKeys)("signIn.backupCodeMfa.title")}),(0,r.tZ)(u.Header.Subtitle,{localizationKey:C(o)?(0,l.localizationKeys)("signIn.forgotPassword.subtitle"):(0,l.localizationKeys)("signIn.backupCodeMfa.subtitle")})]}),(0,r.tZ)(u.Card.Alert,{children:f.error}),(0,r.tZ)(l.Col,{elementDescriptor:l.descriptors.main,gap:8,children:(0,r.BX)(u.Form.Root,{onSubmit:e=>(e.preventDefault(),o.attemptSecondFactor({strategy:"backup_code",code:g.value}).then(e=>{if("complete"===e.status){if(C(e)&&e.createdSessionId){let t=new URLSearchParams;return t.set("createdSessionId",e.createdSessionId),p("../reset-password-success?".concat(t.toString()))}return a({session:e.createdSessionId,redirectUrl:i})}return console.error((0,d.Ws)(e.status,I))}).catch(e=>{if((0,R.ay)(e))return v.__internal_navigateWithError("..",e.errors[0]);(0,m.S3)(e,[g],f.setError)})),children:[(0,r.tZ)(u.Form.ControlRow,{elementId:g.id,children:(0,r.tZ)(u.Form.PlainInput,{...g.props,autoFocus:!0,onActionClicked:t})}),(0,r.BX)(l.Col,{gap:3,children:[(0,r.tZ)(u.Form.SubmitButton,{hasArrow:!0}),(0,r.tZ)(u.Card.Action,{elementId:"alternativeMethods",children:t&&(0,r.tZ)(u.Card.ActionLink,{localizationKey:(0,l.localizationKeys)("footerActionLink__useAnotherMethod"),onClick:t})})]})]})})]}),(0,r.tZ)(u.Card.Footer,{})]})},eo=e=>{let t=(0,s.useCoreSignIn)(),o=(0,u.useCardState)(),{afterSignInUrl:a}=(0,s.useSignInContext)(),{setActive:p}=(0,n.cL)(),{navigate:I}=(0,c.useRouter)(),f=(0,h.H)(),g=(0,n.cL)();i.useEffect(()=>{!e.factorAlreadyPrepared&&(null==v||v())},[]);let v=e.prepare?()=>{var t;return null===(t=e.prepare)||void 0===t?void 0:t.call(e).then(()=>e.onFactorPrepare()).catch(e=>{if((0,R.ay)(e))return g.__internal_navigateWithError("..",e.errors[0]);(0,m.S3)(e,[],o.setError)})}:void 0,C=e=>{var t,o;return(0,z.Vh)(null===(t=e.firstFactorVerification)||void 0===t?void 0:t.strategy)&&(null===(o=e.firstFactorVerification)||void 0===o?void 0:o.status)==="verified"};return(0,r.tZ)(u.VerificationCodeCard,{cardTitle:e.cardTitle,cardSubtitle:C(t)?(0,l.localizationKeys)("signIn.forgotPassword.subtitle"):e.cardSubtitle,resendButton:e.resendButton,inputLabel:e.inputLabel,onCodeEntryFinishedAction:(o,r,n)=>{t.attemptSecondFactor({strategy:e.factor.strategy,code:o}).then(async e=>{if(await r(),"complete"===e.status){if(C(e)&&e.createdSessionId){let t=new URLSearchParams;return t.set("createdSessionId",e.createdSessionId),I("../reset-password-success?".concat(t.toString()))}return p({session:e.createdSessionId,redirectUrl:a})}return console.error((0,d.Ws)(e.status,f))}).catch(e=>(0,R.ay)(e)?g.__internal_navigateWithError("..",e.errors[0]):n(e))},onResendCodeClicked:v,safeIdentifier:"safeIdentifier"in e.factor?e.factor.safeIdentifier:void 0,profileImageUrl:t.userData.imageUrl,onShowAlternativeMethodsClicked:e.onShowAlternativeMethodsClicked,children:C(t)&&(0,r.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("signIn.resetPasswordMfa.detailsLabel"),colorScheme:"secondary"})})},er=e=>{let t=(0,s.useCoreSignIn)();return(0,r.tZ)(l.Flow.Part,{part:"phoneCode2Fa",children:(0,r.tZ)(eo,{...e,cardTitle:(0,l.localizationKeys)("signIn.phoneCodeMfa.title"),cardSubtitle:(0,l.localizationKeys)("signIn.phoneCodeMfa.subtitle"),inputLabel:(0,l.localizationKeys)("signIn.phoneCodeMfa.formTitle"),resendButton:(0,l.localizationKeys)("signIn.phoneCodeMfa.resendButton"),prepare:()=>{let{phoneNumberId:o,strategy:r}=e.factor;return t.prepareSecondFactor({phoneNumberId:o,strategy:r})}})})},en=e=>(0,r.tZ)(l.Flow.Part,{part:"totp2Fa",children:(0,r.tZ)(eo,{...e,cardTitle:(0,l.localizationKeys)("signIn.totpMfa.title"),cardSubtitle:(0,l.localizationKeys)("signIn.totpMfa.subtitle"),inputLabel:(0,l.localizationKeys)("signIn.totpMfa.formTitle")})}),ei=e=>{if(!e)return"";let t=e.strategy;return"phoneNumberId"in e&&(t+=e.phoneNumberId),t},ea=(0,C.Hy)((0,u.withCardStateProvider)(function(){let e=(0,s.useCoreSignIn)().supportedSecondFactors,t=i.useRef(""),[o,n]=i.useState(()=>(0,z.bx)(e)),[a,l]=i.useState(!o),c=()=>l(e=>!e),d=()=>{t.current=ei(o)};if(!o)return(0,r.tZ)(u.LoadingCard,{});if(a)return(0,r.tZ)(Q,{onBackLinkClick:c,onFactorSelected:e=>{n(e),c()}});switch(null==o?void 0:o.strategy){case"phone_code":return(0,r.tZ)(er,{factorAlreadyPrepared:t.current===ei(o),onFactorPrepare:d,factor:o,onShowAlternativeMethodsClicked:c});case"totp":return(0,r.tZ)(en,{factorAlreadyPrepared:t.current===ei(o),onFactorPrepare:d,factor:o,onShowAlternativeMethodsClicked:c});case"backup_code":return(0,r.tZ)(et,{onShowAlternativeMethodsClicked:c});default:return(0,r.tZ)(u.LoadingCard,{})}})),es=(0,C.Hy)(C.L);var el=o("5263"),ec=o("753"),ed=o("3314");let eu=()=>{let[e,t]=(0,i.useState)(!1),{navigate:o}=(0,c.useRouter)(),r=N(()=>o("factor-two")),{userSettings:n}=(0,s.useEnvironment)(),{passkeySettings:a,attributes:l}=n;return(0,i.useEffect)(()=>{async function e(){let e=await (0,el.h_)();t(e),e&&await r({flow:"autofill"})}a.allow_autofill&&l.passkey.enabled&&e()},[]),{isWebAuthnAutofillSupported:e}},ep=e=>{let{field:t}=e,[o,n]=(0,i.useState)(!1),a=(0,i.useRef)(null),s=!!(o||(null==t?void 0:t.value));return((0,i.useLayoutEffect)(()=>{let e=setInterval(()=>{if(null==a?void 0:a.current){var t;let o="onAutoFillStart"===window.getComputedStyle(a.current,":autofill").animationName||!!(null===(t=a.current)||void 0===t?void 0:t.matches("*:-webkit-autofill"));o&&(n(o),clearInterval(e))}},500);return()=>{clearInterval(e)}},[]),(0,i.useEffect)(()=>{(null==t?void 0:t.value)&&""!==t.value&&n(!1)},[null==t?void 0:t.value]),t)?(0,r.tZ)(u.Form.ControlRow,{elementId:t.id,sx:s?void 0:{position:"absolute",opacity:0,height:0,pointerEvents:"none",marginTop:"-1rem"},children:(0,r.tZ)(u.Form.PasswordInput,{...t.props,ref:a,tabIndex:s?void 0:-1})}):null},eh=(0,C.Hy)((0,u.withCardStateProvider)(function(){var e;let t=(0,u.useCardState)(),o=(0,n.cL)(),a=(0,p._m)(),{displayConfig:I,userSettings:f}=(0,s.useEnvironment)(),g=(0,s.useCoreSignIn)(),{navigate:v}=(0,c.useRouter)(),B=(0,s.useSignInContext)(),{afterSignInUrl:S,signUpUrl:w,waitlistUrl:y}=B,_=(0,h.H)(),A=(0,i.useMemo)(()=>(0,C.vX)(f.enabledFirstFactorIdentifiers),[f.enabledFirstFactorIdentifiers]),{isWebAuthnAutofillSupported:b}=eu(),Z=N(()=>v("factor-two")),P=(0,el.iW)(),z=!!(null===(e=B.initialValues)||void 0===e?void 0:e.phoneNumber)&&!(B.initialValues.emailAddress||B.initialValues.username)&&A.includes("phone_number"),[E,L]=(0,i.useState)(z?"phone_number":A[0]||""),[K,x]=(0,i.useState)(!1),T=(0,ed.XV)("__clerk_ticket")||"",M=f.enabledFirstFactorIdentifiers,R=f.web3FirstFactors,U=f.authenticatableSocialStrategies,D=f.instanceIsPasswordBased,{currentIdentifier:O,nextIdentifier:H}=(0,C.vO)(A,E),X=(0,m.Yp)("password","",{type:"password",label:(0,l.localizationKeys)("formFieldLabel__password"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__password")}),$=B.initialValues||{},W=(0,i.useMemo)(()=>({email_address:$.emailAddress,email_address_username:$.emailAddress||$.username,username:$.username,phone_number:$.phoneNumber}),[B.initialValues]),V=!!U.length||!!R.length,[G,j]=(0,i.useState)(!(0,m.s2)()&&!V),Y=(0,m.Yp)("identifier",W[E]||"",{...O,isRequired:!0,transformer:e=>e.trim()}),q=(0,m.Yp)("identifier",W.phone_number||"",{...O,isRequired:!0}),J="phone_number"===E?q:Y,Q=e=>{Y.setValue(W[E]||""),q.setValue(e),L("phone_number"),j(!0)};(0,i.useLayoutEffect)(()=>{J.value.startsWith("+")&&A.includes("phone_number")&&"phone_number"!==E&&!K&&(Q(J.value),x(!0))},[J.value,A]),(0,i.useEffect)(()=>{T&&(a.setLoading(),t.setLoading(),g.create({strategy:"ticket",ticket:T}).then(e=>{switch(e.status){case"needs_first_factor":return v("factor-one");case"needs_second_factor":return v("factor-two");case"complete":return(0,ed.xy)("__clerk_ticket"),o.setActive({session:e.createdSessionId,redirectUrl:S});default:console.error((0,d.Ws)(e.status,_));return}}).catch(e=>en(e)).finally(()=>{a.setIdle(),t.setIdle()}))},[]),(0,i.useEffect)(()=>{(async function(){var e;let o=null==g?void 0:null===(e=g.firstFactorVerification)||void 0===e?void 0:e.error;if(o){switch(o.code){case ec.O1.NOT_ALLOWED_TO_SIGN_UP:case ec.O1.OAUTH_ACCESS_DENIED:case ec.O1.NOT_ALLOWED_ACCESS:case ec.O1.SAML_USER_ATTRIBUTE_MISSING:case ec.O1.OAUTH_EMAIL_DOMAIN_RESERVED_BY_SAML:case ec.O1.USER_LOCKED:case ec.O1.EXTERNAL_ACCOUNT_NOT_FOUND:case ec.O1.SIGN_UP_MODE_RESTRICTED:case ec.O1.SIGN_UP_MODE_RESTRICTED_WAITLIST:case ec.O1.ENTERPRISE_SSO_USER_ATTRIBUTE_MISSING:case ec.O1.ENTERPRISE_SSO_EMAIL_ADDRESS_DOMAIN_MISMATCH:case ec.O1.ENTERPRISE_SSO_HOSTED_DOMAIN_MISMATCH:case ec.O1.SAML_EMAIL_ADDRESS_DOMAIN_MISMATCH:t.setError(o);break;default:t.setError("Unable to complete action at this time. If the problem persists please contact support.")}await g.create({})}})()},[]);let ee=e=>{let t=e.some(e=>"password"===e.name&&!!e.value);return(!t||f.enterpriseSSO.enabled)&&(e=e.filter(e=>"password"!==e.name)),{...(0,m.ni)(e),...t&&!f.enterpriseSSO.enabled&&{strategy:"password"}}},et=(e,t)=>e.then(e=>{var o,r;if(!f.enterpriseSSO.enabled)return e;let n=null===(o=t.find(e=>"password"===e.name))||void 0===o?void 0:o.value;return!n||(null===(r=e.supportedFirstFactors)||void 0===r?void 0:r.some(e=>"saml"===e.strategy||"enterprise_sso"===e.strategy))?e:e.attemptFirstFactor({strategy:"password",password:n})}),eo=async function(){for(var e,t,r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];try{let r=await et(g.create(ee(n)),n);switch(r.status){case"needs_identifier":(null===(e=r.supportedFirstFactors)||void 0===e?void 0:e.some(e=>"saml"===e.strategy||"enterprise_sso"===e.strategy))&&await er();break;case"needs_first_factor":if(null===(t=r.supportedFirstFactors)||void 0===t?void 0:t.every(e=>"enterprise_sso"===e.strategy)){await er();break}return v("factor-one");case"needs_second_factor":return v("factor-two");case"complete":return o.setActive({session:r.createdSessionId,redirectUrl:S});default:console.error((0,d.Ws)(r.status,_));return}}catch(e){return en(e)}},er=async()=>{let e=(0,k.w)(B,I.signInUrl),t=B.afterSignInUrl||"/";return g.authenticateWithRedirect({strategy:"enterprise_sso",redirectUrl:e,redirectUrlComplete:t})},en=async e=>{if(!e.errors)return;let r=e.errors.find(e=>e.code===ec.O1.INVALID_STRATEGY_FOR_USER||e.code===ec.O1.FORM_PASSWORD_INCORRECT),n=e.errors.find(e=>"identifier_already_signed_in"===e.code);if(r)await eo(J);else if(n){let e=n.meta.sessionId;await o.setActive({session:e,redirectUrl:S})}else(0,m.S3)(e,[J,X],t.setError)},ei=async e=>(e.preventDefault(),eo(J,X)),ea=(0,i.useMemo)(()=>({tel:u.Form.PhoneInput,password:u.Form.PasswordInput,text:u.Form.PlainInput,email:u.Form.PlainInput})[J.type],[J.type]);if(a.isLoading)return(0,r.tZ)(u.LoadingCard,{});let{action:es,...eh}=J.props;return(0,r.tZ)(l.Flow.Part,{part:"start",children:(0,r.BX)(u.Card.Root,{children:[(0,r.BX)(u.Card.Content,{children:[(0,r.BX)(u.Header.Root,{showLogo:!0,children:[(0,r.tZ)(u.Header.Title,{localizationKey:(0,l.localizationKeys)("signIn.start.title")}),(0,r.tZ)(u.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("signIn.start.subtitle")})]}),(0,r.tZ)(u.Card.Alert,{children:t.error}),(0,r.BX)(l.Col,{elementDescriptor:l.descriptors.main,gap:6,children:[(0,r.BX)(u.SocialButtonsReversibleContainerWithDivider,{children:[V&&(0,r.tZ)(F,{enableWeb3Providers:!0,enableOAuthProviders:!0}),M.length?(0,r.BX)(u.Form.Root,{onSubmit:ei,gap:8,children:[(0,r.BX)(l.Col,{gap:6,children:[(0,r.tZ)(u.Form.ControlRow,{elementId:J.id,children:(0,r.tZ)(ea,{actionLabel:null==H?void 0:H.action,onActionClicked:()=>{L(e=>A[(A.indexOf(e)+1)%A.length]),j(!0),x(!1)},...eh,autoFocus:G,autoComplete:b?"webauthn":void 0})}),(0,r.tZ)(ep,{field:D?X:void 0})]}),(0,r.tZ)(u.Form.SubmitButton,{hasArrow:!0})]}):null]}),f.attributes.passkey.enabled&&f.passkeySettings.show_sign_in_button&&P&&(0,r.tZ)(u.Card.Action,{elementId:"usePasskey",children:(0,r.tZ)(u.Card.ActionLink,{localizationKey:(0,l.localizationKeys)("signIn.start.actionLink__use_passkey"),onClick:()=>Z({flow:"discoverable"})})})]})]}),(0,r.BX)(u.Card.Footer,{children:[f.signUp.mode===ec.ci.PUBLIC&&(0,r.BX)(u.Card.Action,{elementId:"signIn",children:[(0,r.tZ)(u.Card.ActionText,{localizationKey:(0,l.localizationKeys)("signIn.start.actionText")}),(0,r.tZ)(u.Card.ActionLink,{localizationKey:(0,l.localizationKeys)("signIn.start.actionLink"),to:o.buildUrlWithAuth(w)})]}),f.signUp.mode===ec.ci.WAITLIST&&(0,r.BX)(u.Card.Action,{elementId:"signIn",children:[(0,r.tZ)(u.Card.ActionText,{localizationKey:(0,l.localizationKeys)("signIn.start.actionText__join_waitlist")}),(0,r.tZ)(u.Card.ActionLink,{localizationKey:(0,l.localizationKeys)("signIn.start.actionLink__join_waitlist"),to:o.buildUrlWithAuth(y)})]})]})]})})}));function em(){let e=(0,n.cL)();return i.useEffect(()=>{e.redirectToSignIn()},[]),null}function eI(){let e=(0,s.useSignInContext)();return(0,r.tZ)(l.Flow.Root,{flow:"signIn",children:(0,r.BX)(c.Switch,{children:[(0,r.tZ)(c.Route,{path:"factor-one",children:(0,r.tZ)(J,{})}),(0,r.tZ)(c.Route,{path:"factor-two",children:(0,r.tZ)(ea,{})}),(0,r.tZ)(c.Route,{path:"reset-password",children:(0,r.tZ)(I,{})}),(0,r.tZ)(c.Route,{path:"reset-password-success",children:(0,r.tZ)(v,{})}),(0,r.tZ)(c.Route,{path:"sso-callback",children:(0,r.tZ)(es,{signUpUrl:e.signUpUrl,signInUrl:e.signInUrl,signInForceRedirectUrl:e.afterSignInUrl,signUpForceRedirectUrl:e.afterSignUpUrl,continueSignUpUrl:e.signUpContinueUrl,transferable:e.transferable,firstFactorUrl:"../factor-one",secondFactorUrl:"../factor-two",resetPasswordUrl:"../reset-password"})}),(0,r.tZ)(c.Route,{path:"choose",children:(0,r.tZ)(_,{})}),(0,r.tZ)(c.Route,{path:"verify",children:(0,r.tZ)(a.J,{redirectUrlComplete:e.afterSignInUrl,redirectUrl:"../factor-two"})}),(0,r.tZ)(c.Route,{index:!0,children:(0,r.tZ)(eh,{})}),(0,r.tZ)(c.Route,{children:(0,r.tZ)(em,{})})]})})}eI.displayName="SignIn";let ef=(0,s.withCoreSessionSwitchGuard)(eI),eg=e=>{let t={signUpUrl:"/".concat(c.VIRTUAL_ROUTER_BASE_PATH,"/sign-up"),waitlistUrl:"/".concat(c.VIRTUAL_ROUTER_BASE_PATH,"/waitlist"),...e};return(0,r.tZ)(c.Route,{path:"sign-in",children:(0,r.tZ)(s.SignInContext.Provider,{value:{componentName:"SignIn",...t,routing:"virtual"},children:(0,r.tZ)("div",{children:(0,r.tZ)(ef,{...t,routing:"virtual"})})})})}},5518:function(e,t,o){o.d(t,{Vh:function(){return h},bx:function(){return u},t3:function(){return l},xT:function(){return d}}),o(5670);var r=o(5263),n=o(7772),i=o(881);let a=e=>t=>"safeIdentifier"in t&&t.safeIdentifier===e;function s(e){if((0,r.iW)()){let t=e.find(e=>{let{strategy:t}=e;return"passkey"===t});if(t)return t}return null}function l(e,t,o){return e&&0!==e.length?o===n.kJ.Password?function(e,t){let o=s(e);if(o)return o;let r=e.sort(i.sZ)[0];return"password"===r.strategy?r:e.find(a(t))||r||null}(e,t):function(e,t){let o=s(e);if(o)return o;let r=e.sort(i.b8),n=r.find(a(t));if(n)return n;let l=r[0];return"email_link"===l.strategy?l:e.find(a(t))||l||null}(e,t):null}let c=["passkey","email_code","password","phone_code","email_link"];function d(e){return!!e&&c.includes(e.strategy)}function u(e){if(!e||0===e.length)return null;let t=e.find(e=>"totp"===e.strategy);if(t)return t;let o=e.find(e=>"phone_code"===e.strategy);return o||e[0]}let p=["reset_password_phone_code","reset_password_email_code"],h=e=>!!e&&p.includes(e)},9327:function(e,t,o){o.d(t,{fB:function(){return d},gW:function(){return p},uj:function(){return u}});var r=o(7126),n=o(4676),i=o(1673),a=o(7571),s=o(3064),l=o(9885),c=o(8655);let d=e=>{let{navigate:t}=(0,n.useRouter)(),{handleManageAccountClicked:o,handleSignOutSessionClicked:c,handleUserProfileActionClicked:d,session:u}=e,{menutItems:p}=(0,a.useUserButtonContext)(),h=e=>({borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,padding:"".concat(e.space.$4," ").concat(e.space.$5)}),m=async r=>{var n;return(null==r?void 0:r.path)?(await t(r.path),null==e?void 0:e.completedCallback()):r.id===i.Zb.MANAGE_ACCOUNT?await o():(null==r?void 0:r.open)?d(r.open):(null===(n=r.onClick)||void 0===n||n.call(r),null==e?void 0:e.completedCallback())};return(0,r.tZ)(l.Actions,{role:"menu",elementDescriptor:s.descriptors.userButtonPopoverActions,elementId:s.descriptors.userButtonPopoverActions.setId("singleSession"),sx:e=>({borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100}),children:null==p?void 0:p.map(e=>{let t;return t=Object.values(i.Zb).includes(e.id)?{elementDescriptor:s.descriptors.userButtonPopoverActionButton,elementId:s.descriptors.userButtonPopoverActionButton.setId(e.id),iconBoxElementDescriptor:s.descriptors.userButtonPopoverActionButtonIconBox,iconBoxElementId:s.descriptors.userButtonPopoverActionButtonIconBox.setId(e.id),iconElementDescriptor:s.descriptors.userButtonPopoverActionButtonIcon,iconElementId:s.descriptors.userButtonPopoverActionButtonIcon.setId(e.id)}:{elementDescriptor:s.descriptors.userButtonPopoverCustomItemButton,elementId:s.descriptors.userButtonPopoverCustomItemButton.setId(e.id),iconBoxElementDescriptor:s.descriptors.userButtonPopoverCustomItemButtonIconBox,iconBoxElementId:s.descriptors.userButtonPopoverCustomItemButtonIconBox.setId(e.id),iconElementDescriptor:s.descriptors.userButtonPopoverActionItemButtonIcon,iconElementId:s.descriptors.userButtonPopoverActionItemButtonIcon.setId(e.id)},(0,r.tZ)(l.Action,{...t,icon:e.icon,label:e.name,onClick:e.id===i.Zb.SIGN_OUT?c(u):()=>m(e),sx:h,iconSx:e=>({width:e.sizes.$4,height:e.sizes.$4})},e.id)})})},u=e=>{let{navigate:t}=(0,n.useRouter)(),{handleManageAccountClicked:o,handleSignOutSessionClicked:d,handleSessionClicked:u,handleAddAccountClicked:p,handleUserProfileActionClicked:h,session:m,otherSessions:I}=e,{menutItems:f}=(0,a.useUserButtonContext)(),g=async r=>{var n;return(null==r?void 0:r.path)?(await t(r.path),null==e?void 0:e.completedCallback()):r.id===i.Zb.MANAGE_ACCOUNT?await o():(null==r?void 0:r.open)?h(r.open):(null===(n=r.onClick)||void 0===n||n.call(r),null==e?void 0:e.completedCallback())},v=f.every(e=>Object.values(i.Zb).includes(e.id));return(0,r.BX)(r.HY,{children:[v?(0,r.tZ)(l.SmallActions,{role:"menu",elementDescriptor:s.descriptors.userButtonPopoverActions,elementId:s.descriptors.userButtonPopoverActions.setId("multiSession"),children:(0,r.BX)(s.Flex,{justify:"between",sx:e=>({marginLeft:e.space.$12,padding:"0 ".concat(e.space.$5," ").concat(e.space.$4),gap:e.space.$2}),children:[(0,r.tZ)(l.SmallAction,{elementDescriptor:s.descriptors.userButtonPopoverActionButton,elementId:s.descriptors.userButtonPopoverActionButton.setId("manageAccount"),iconBoxElementDescriptor:s.descriptors.userButtonPopoverActionButtonIconBox,iconBoxElementId:s.descriptors.userButtonPopoverActionButtonIconBox.setId("manageAccount"),iconElementDescriptor:s.descriptors.userButtonPopoverActionButtonIcon,iconElementId:s.descriptors.userButtonPopoverActionButtonIcon.setId("manageAccount"),icon:c.tc,label:(0,s.localizationKeys)("userButton.action__manageAccount"),onClick:o}),(0,r.tZ)(l.SmallAction,{elementDescriptor:s.descriptors.userButtonPopoverActionButton,elementId:s.descriptors.userButtonPopoverActionButton.setId("signOut"),iconBoxElementDescriptor:s.descriptors.userButtonPopoverActionButtonIconBox,iconBoxElementId:s.descriptors.userButtonPopoverActionButtonIconBox.setId("signOut"),iconElementDescriptor:s.descriptors.userButtonPopoverActionButtonIcon,iconElementId:s.descriptors.userButtonPopoverActionButtonIcon.setId("signOut"),icon:c.lv,label:(0,s.localizationKeys)("userButton.action__signOut"),onClick:d(m)})]})}):(0,r.tZ)(l.SmallActions,{role:"menu",elementDescriptor:s.descriptors.userButtonPopoverActions,elementId:s.descriptors.userButtonPopoverActions.setId("multiSession"),sx:e=>({gap:e.space.$1,paddingBottom:e.space.$2}),children:null==f?void 0:f.map(e=>{let t;return t=Object.values(i.Zb).includes(e.id)?{elementDescriptor:s.descriptors.userButtonPopoverActionButton,elementId:s.descriptors.userButtonPopoverActionButton.setId(e.id),iconBoxElementDescriptor:s.descriptors.userButtonPopoverActionButtonIconBox,iconBoxElementId:s.descriptors.userButtonPopoverActionButtonIconBox.setId(e.id),iconElementDescriptor:s.descriptors.userButtonPopoverActionButtonIcon,iconElementId:s.descriptors.userButtonPopoverActionButtonIcon.setId(e.id)}:{elementDescriptor:s.descriptors.userButtonPopoverCustomItemButton,elementId:s.descriptors.userButtonPopoverCustomItemButton.setId(e.id),iconBoxElementDescriptor:s.descriptors.userButtonPopoverCustomItemButtonIconBox,iconBoxElementId:s.descriptors.userButtonPopoverCustomItemButtonIconBox.setId(e.id),iconElementDescriptor:s.descriptors.userButtonPopoverActionItemButtonIcon,iconElementId:s.descriptors.userButtonPopoverActionItemButtonIcon.setId(e.id)},(0,r.tZ)(l.Action,{...t,icon:e.icon,label:e.name,onClick:e.id===i.Zb.SIGN_OUT?d(m):()=>g(e),sx:e=>({border:0,padding:"".concat(e.space.$2," ").concat(e.space.$5),gap:e.space.$3x5}),iconSx:e=>({width:e.sizes.$4,height:e.sizes.$4}),iconBoxSx:e=>({minHeight:e.sizes.$4,minWidth:e.sizes.$4,alignItems:"center"})},e.id)})}),(0,r.BX)(l.Actions,{role:"menu",sx:e=>({borderTopStyle:e.borderStyles.$solid,borderTopWidth:e.borderWidths.$normal,borderTopColor:e.colors.$neutralAlpha100}),children:[I.map(e=>(0,r.tZ)(l.PreviewButton,{icon:c.nR,onClick:u(e),role:"menuitem",children:(0,r.tZ)(l.UserPreview,{user:e.user})},e.id)),(0,r.tZ)(l.Action,{elementDescriptor:s.descriptors.userButtonPopoverActionButton,elementId:s.descriptors.userButtonPopoverActionButton.setId("addAccount"),iconBoxElementDescriptor:s.descriptors.userButtonPopoverActionButtonIconBox,iconBoxElementId:s.descriptors.userButtonPopoverActionButtonIconBox.setId("addAccount"),iconElementDescriptor:s.descriptors.userButtonPopoverActionButtonIcon,iconElementId:s.descriptors.userButtonPopoverActionButtonIcon.setId("addAccount"),icon:c.mm,label:(0,s.localizationKeys)("userButton.action__addAccount"),onClick:p,iconSx:e=>({width:e.sizes.$9,height:e.sizes.$6}),iconBoxSx:e=>({minHeight:e.sizes.$9,minWidth:e.sizes.$6,alignItems:"center"}),spinnerSize:"md"})]})]})},p=e=>{let{handleSignOutAllClicked:t,elementDescriptor:o,elementId:n,iconBoxElementDescriptor:i,iconBoxElementId:a,iconElementDescriptor:d,iconElementId:u,label:p,sx:h,actionSx:m}=e;return(0,r.tZ)(l.Actions,{role:"menu",sx:[e=>({padding:e.space.$2}),h],children:(0,r.tZ)(l.Action,{elementDescriptor:o||s.descriptors.userButtonPopoverActionButton,elementId:n||s.descriptors.userButtonPopoverActionButton.setId("signOutAll"),iconBoxElementDescriptor:i||s.descriptors.userButtonPopoverActionButtonIconBox,iconBoxElementId:a||s.descriptors.userButtonPopoverActionButtonIconBox.setId("signOutAll"),iconElementDescriptor:d||s.descriptors.userButtonPopoverActionButtonIcon,iconElementId:u||s.descriptors.userButtonPopoverActionButtonIcon.setId("signOutAll"),icon:c.lv,label:p||(0,s.localizationKeys)("userButton.action__signOutAll"),onClick:t,variant:"ghost",colorScheme:"neutral",sx:[e=>({backgroundColor:e.colors.$transparent,padding:"".concat(e.space.$2," ").concat(e.space.$3),borderBottomWidth:0,borderRadius:e.radii.$lg}),m],spinnerSize:"md"})})}},5241:function(e,t,o){o.d(t,{Z:function(){return c}});var r=o(2631),n=o(5809),i=o(9885),a=o(4264),s=o(4676),l=o(1132);let c=e=>{let{setActive:t,signOut:o,openUserProfile:c}=(0,r.cL)(),d=(0,i.useCardState)(),{activeSessions:u,otherSessions:p}=(0,a.j)({user:e.user}),{navigate:h}=(0,s.useRouter)();return{handleSignOutSessionClicked:t=>()=>0===p.length?o(e.navigateAfterSignOut):o(e.navigateAfterMultiSessionSingleSignOut,{sessionId:t.id}).finally(()=>d.setIdle()),handleManageAccountClicked:()=>{var t;return"navigation"===e.userProfileMode?h(e.userProfileUrl||"").finally(()=>{(async()=>{var t;await (0,l._v)(300),null===(t=e.actionCompleteCallback)||void 0===t||t.call(e)})()}):(c(e.userProfileProps),null===(t=e.actionCompleteCallback)||void 0===t?void 0:t.call(e))},handleUserProfileActionClicked:t=>{var o;return"navigation"===e.userProfileMode?h(e.userProfileUrl||"").finally(()=>{(async()=>{var t;await (0,l._v)(300),null===(t=e.actionCompleteCallback)||void 0===t||t.call(e)})()}):(c({...e.userProfileProps,...t&&{__experimental_startPath:t}}),null===(o=e.actionCompleteCallback)||void 0===o?void 0:o.call(e))},handleSignOutAllClicked:()=>o(e.navigateAfterSignOut),handleSessionClicked:o=>async()=>(d.setLoading(),t({session:o,redirectUrl:e.afterSignInUrl}).finally(()=>{var t;d.setIdle(),null===(t=e.actionCompleteCallback)||void 0===t||t.call(e)})),handleAddAccountClicked:()=>((0,n.T7)(e.signInUrl||window.location.href),(0,l._v)(2e3)),otherSessions:p,activeSessions:u}}}}]);